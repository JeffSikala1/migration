apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  annotations:
    kubernetes.io/ingress.class: "ingress-nginx"
    #alb.ingress.kubernetes.io/group.name: conexus-httpd
    alb.ingress.kubernetes.io/certificate-arn: arn:aws:acm:us-east-1:957770628377:certificate/74f3b378-2854-4cb1-9ea1-e2c02e0a99d1
    alb.ingress.kubernetes.io/listen-ports: '[{"HTTP": 80}, {"HTTPS": 443}]'
    alb.ingress.kubernetes.io/scheme: internet-facing      
    alb.ingress.kubernetes.io/target-type: instance
    alb.ingress.kubernetes.io/ssl-redirect: '443'
    alb.ingress.kubernetes.io/actions.ssl-redirect: '{"Type": "redirect", "RedirectConfig": { "Protocol": "HTTPS", "Port": "443", "StatusCode": "HTTP_301"}}'
    # Health Check Settings
    alb.ingress.kubernetes.io/healthcheck-protocol: HTTP 
    alb.ingress.kubernetes.io/healthcheck-port: traffic-port
    alb.ingress.kubernetes.io/healthcheck-path: /
    alb.ingress.kubernetes.io/healthcheck-interval-seconds: '15'
    alb.ingress.kubernetes.io/healthcheck-timeout-seconds: '5'
    alb.ingress.kubernetes.io/success-codes: '200-499'
    alb.ingress.kubernetes.io/healthy-threshold-count: '2'
    alb.ingress.kubernetes.io/unhealthy-threshold-count: '2'
  labels:
    app: conexus-httpd
    run: conexus-httpd
    app.kubernetes.io/name: conexus-httpd
  namespace: ingress-nginx
  name: conexus-httpd-ingress
spec:
  ingressClassName: ingress-nginx
  rules:
  - host: sandbox.conexus-project.org
    http:
      paths:
      - path: /
        #pathType: ImplementationSpecific
        pathType: Prefix
        backend:
          service:
            name: conexus-httpd 
            port:
              number: 80        
  tls:
  - hosts:
    - sandbox.conexus-project.org                       
